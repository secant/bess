import scapy.all as scapy
import glob
import socket
import time
import commands

def aton(ip):
  return socket.inet_aton(ip)

# All this does is subject a module to load and make sure it 
# doesn't crash
def crash_test(module, num_input_ports, num_output_ports):
  for i in range(num_input_ports):
    src = Source()
    src -> i:module
  for i in range(num_output_ports):
    sink = Sink()
    module:i -> sink

  time.sleep(30)


for file in glob.glob("conf/testing/module_tests/*.py"):
  CRASH_TEST_INPUTS = []

  execfile(file)

  crash_testid = 1
  for test in CRASH_TEST_INPUTS:
    crash_test(test[0], test[1], test[2])
    print(str(test[0]) + " crash test " + str(crash_testid) + ": PASS")
